<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Visible: src/visual/code/model.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Visible"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rfymovicon.tiff"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Visible
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('model_8cpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">model.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;_highgui.h&quot;</code><br/>
<code>#include &quot;cv.h&quot;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;cassert&gt;</code><br/>
<code>#include &lt;Carbon/Carbon.h&gt;</code><br/>
<code>#include &lt;CoreFoundation/CoreFoundation.h&gt;</code><br/>
<code>#include &lt;QuickTime/QuickTime.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for model.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="model_8cpp__incl.svg" width="100%" height="388"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="model_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Movie state structure for QuickTime movies.  <a href="struct_cv_capture___q_t___movie.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam_barg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a83b0b97297d8951cda6d62710e1143a6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a83b0b97297d8951cda6d62710e1143a6">CvCapture_QT_Movie</a></td></tr>
<tr class="memdesc:a83b0b97297d8951cda6d62710e1143a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Movie state structure for QuickTime movies.  <a href="#a83b0b97297d8951cda6d62710e1143a6">More...</a><br/></td></tr>
<tr class="separator:a83b0b97297d8951cda6d62710e1143a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd38e6e426619bef990fd9f1c6c94657"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam_barg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a></td></tr>
<tr class="separator:acd38e6e426619bef990fd9f1c6c94657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab492a14a352c81f84f864f343142560"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#aab492a14a352c81f84f864f343142560">CvVideoWriter_QT</a></td></tr>
<tr class="separator:aab492a14a352c81f84f864f343142560"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a50bd7fb72964a02cb976ff34d75ce1cd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a50bd7fb72964a02cb976ff34d75ce1cd">icvOpenFile_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture, const char *filename)</td></tr>
<tr class="separator:a50bd7fb72964a02cb976ff34d75ce1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94371ac572b7b5bcdfc3bd26b5f53911"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a94371ac572b7b5bcdfc3bd26b5f53911">icvClose_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture)</td></tr>
<tr class="separator:a94371ac572b7b5bcdfc3bd26b5f53911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85020f6603a6547001bf8721656ad706"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a85020f6603a6547001bf8721656ad706">icvGetProperty_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture, int property_id)</td></tr>
<tr class="separator:a85020f6603a6547001bf8721656ad706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c67e69138599d1acab7910e30278d33"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a2c67e69138599d1acab7910e30278d33">icvSetProperty_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture, int property_id, double value)</td></tr>
<tr class="separator:a2c67e69138599d1acab7910e30278d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d146e4c912ae502f9a33a4773d4661"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#af0d146e4c912ae502f9a33a4773d4661">icvGrabFrame_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture)</td></tr>
<tr class="separator:af0d146e4c912ae502f9a33a4773d4661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec296cc7fb38a048d40a8ffeded6955a"><td class="memItemLeft" align="right" valign="top">static const void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#aec296cc7fb38a048d40a8ffeded6955a">icvRetrieveFrame_QT_Movie</a> (<a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *capture)</td></tr>
<tr class="separator:aec296cc7fb38a048d40a8ffeded6955a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b0bd3f8986c2bfc219ef6e8a11d6ac"><td class="memItemLeft" align="right" valign="top">CvCapture *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a86b0bd3f8986c2bfc219ef6e8a11d6ac">cvCaptureFromFile_QT</a> (const char *filename)</td></tr>
<tr class="separator:a86b0bd3f8986c2bfc219ef6e8a11d6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e2854609da08709c8cfe52a33ac543"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#aa9e2854609da08709c8cfe52a33ac543">icvOpenCamera_QT</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture, const int index)</td></tr>
<tr class="separator:aa9e2854609da08709c8cfe52a33ac543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572ed4a04e0129bd44db7839d3616949"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a572ed4a04e0129bd44db7839d3616949">icvClose_QT_Cam</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture)</td></tr>
<tr class="separator:a572ed4a04e0129bd44db7839d3616949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41db6456f1485b1d5e81c90c00cceb8e"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a41db6456f1485b1d5e81c90c00cceb8e">icvGetProperty_QT_Cam</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture, int property_id)</td></tr>
<tr class="memdesc:a41db6456f1485b1d5e81c90c00cceb8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">capture properties currently unimplemented for QuickTime camera interface  <a href="#a41db6456f1485b1d5e81c90c00cceb8e">More...</a><br/></td></tr>
<tr class="separator:a41db6456f1485b1d5e81c90c00cceb8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33e22d6a68e54e7592b7b195323d0e8c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a33e22d6a68e54e7592b7b195323d0e8c">icvSetProperty_QT_Cam</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture, int property_id, double value)</td></tr>
<tr class="memdesc:a33e22d6a68e54e7592b7b195323d0e8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">capture properties currently unimplemented for QuickTime camera interface  <a href="#a33e22d6a68e54e7592b7b195323d0e8c">More...</a><br/></td></tr>
<tr class="separator:a33e22d6a68e54e7592b7b195323d0e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7895bf39c5efdaba93e7a4c50f8858b7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a7895bf39c5efdaba93e7a4c50f8858b7">icvGrabFrame_QT_Cam</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture)</td></tr>
<tr class="separator:a7895bf39c5efdaba93e7a4c50f8858b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecd5e598aed1d847417d4f9ccb56343"><td class="memItemLeft" align="right" valign="top">static const void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#acecd5e598aed1d847417d4f9ccb56343">icvRetrieveFrame_QT_Cam</a> (<a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *capture)</td></tr>
<tr class="separator:acecd5e598aed1d847417d4f9ccb56343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3317c56d4a7780b20ca7a6ac497093a9"><td class="memItemLeft" align="right" valign="top">CvCapture *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a3317c56d4a7780b20ca7a6ac497093a9">cvCaptureFromCAM_QT</a> (const int index)</td></tr>
<tr class="separator:a3317c56d4a7780b20ca7a6ac497093a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61083c7a86014e3c5b70cb1bce82024"><td class="memItemLeft" align="right" valign="top">static OSErr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#ac61083c7a86014e3c5b70cb1bce82024">icvDataProc_QT_Cam</a> (SGChannel channel, Ptr raw_data, long len, long *, long, TimeValue, short, long refCon)</td></tr>
<tr class="separator:ac61083c7a86014e3c5b70cb1bce82024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d6a9e8427c3f98bd96e095acece3019"><td class="memItemLeft" align="right" valign="top">OSStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a0d6a9e8427c3f98bd96e095acece3019">icvEncodedFrameOutputCallback</a> (void *writer, ICMCompressionSessionRef compression_session_ref, OSStatus error, ICMEncodedFrameRef encoded_frame_ref, void *reserved)</td></tr>
<tr class="separator:a0d6a9e8427c3f98bd96e095acece3019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d5370476eb03932f2aced2b7e577bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#ad7d5370476eb03932f2aced2b7e577bd">icvSourceTrackingCallback</a> (void *source_tracking_ref_con, ICMSourceTrackingFlags source_tracking_flags, void *source_frame_ref_con, void *reserved)</td></tr>
<tr class="separator:ad7d5370476eb03932f2aced2b7e577bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b8728b32f8cf36ebc87e18841c4814"><td class="memItemLeft" align="right" valign="top">CV_IMPL CvVideoWriter *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#ac6b8728b32f8cf36ebc87e18841c4814">cvCreateVideoWriter</a> (const char *filename, int fourcc, double fps, CvSize frame_size, int is_color)</td></tr>
<tr class="separator:ac6b8728b32f8cf36ebc87e18841c4814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a117104b1ecf7a5e7cb747db9a68ad3"><td class="memItemLeft" align="right" valign="top">CV_IMPL int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a0a117104b1ecf7a5e7cb747db9a68ad3">cvWriteFrame</a> (CvVideoWriter *writer, const IplImage *image)</td></tr>
<tr class="separator:a0a117104b1ecf7a5e7cb747db9a68ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c69d6abc1de26affe5f05c80556544"><td class="memItemLeft" align="right" valign="top">CV_IMPL void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#ae9c69d6abc1de26affe5f05c80556544">cvReleaseVideoWriter</a> (CvVideoWriter **writer)</td></tr>
<tr class="separator:ae9c69d6abc1de26affe5f05c80556544"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0189ed6361bd1be03be79c2be6c3ad11"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a> = 0</td></tr>
<tr class="separator:a0189ed6361bd1be03be79c2be6c3ad11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ad9f314e0fc25afc7b31b390af4cd9"><td class="memItemLeft" align="right" valign="top">static CvCaptureVTable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a10ad9f314e0fc25afc7b31b390af4cd9">capture_QT_Movie_vtable</a></td></tr>
<tr class="separator:a10ad9f314e0fc25afc7b31b390af4cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a036076d0c44cb1eea47533204801b0e8"><td class="memItemLeft" align="right" valign="top">static CvCaptureVTable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a036076d0c44cb1eea47533204801b0e8">capture_QT_Cam_vtable</a></td></tr>
<tr class="separator:a036076d0c44cb1eea47533204801b0e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6c76d3725e7fab57e3371d4e8ec368"><td class="memItemLeft" align="right" valign="top">static TimeScale const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model_8cpp.html#a2a6c76d3725e7fab57e3371d4e8ec368">TIME_SCALE</a> = 600</td></tr>
<tr class="separator:a2a6c76d3725e7fab57e3371d4e8ec368"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="acd38e6e426619bef990fd9f1c6c94657"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam_barg</a>  <a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a83b0b97297d8951cda6d62710e1143a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a>  <a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Movie state structure for QuickTime movies. </p>

</div>
</div>
<a class="anchor" id="aab492a14a352c81f84f864f343142560"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>  <a class="el" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3317c56d4a7780b20ca7a6ac497093a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CvCapture* cvCaptureFromCAM_QT </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize memory structure and call method to open camera</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2006-01-29 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00618">618</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00600">capture_QT_Cam_vtable</a>, <a class="el" href="model_8cpp_source.html#l00068">did_enter_movies</a>, <a class="el" href="model_8cpp_source.html#l00934">icvOpenCamera_QT()</a>, and <a class="el" href="model_8cpp_source.html#l00574">CvCapture_QT_Cam_barg::vtable</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;       <span class="keywordflow">if</span> (! <a class="code" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a>)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;       {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;             EnterMovies();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;             <a class="code" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a> = 1;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;       </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;     <a class="code" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam</a> * capture = 0;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;       </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;     <span class="keywordflow">if</span> (index &gt;= 0)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         capture = (<a class="code" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam</a> *) cvAlloc (<span class="keyword">sizeof</span> (*capture));</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         memset (capture, 0, <span class="keyword">sizeof</span>(*capture));</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;             </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#adaaed55c9dce40c1c3ec1dd28f83d670">vtable</a> = &amp;<a class="code" href="model_8cpp.html#a036076d0c44cb1eea47533204801b0e8">capture_QT_Cam_vtable</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;       </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="model_8cpp.html#aa9e2854609da08709c8cfe52a33ac543">icvOpenCamera_QT</a> (capture, index))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;             cvReleaseCapture ((CvCapture**) &amp; capture);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;       </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     <span class="keywordflow">return</span> (CvCapture *) capture;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_a3317c56d4a7780b20ca7a6ac497093a9_cgraph.svg" width="576" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a86b0bd3f8986c2bfc219ef6e8a11d6ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CvCapture* cvCaptureFromFile_QT </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00114">114</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00102">capture_QT_Movie_vtable</a>, <a class="el" href="model_8cpp_source.html#l00068">did_enter_movies</a>, <a class="el" href="model_8cpp_source.html#l00150">icvOpenFile_QT_Movie()</a>, and <a class="el" href="model_8cpp_source.html#l00076">CvCapture_QT_Movie::vtable</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a> = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       <span class="keywordflow">if</span> (! did_enter_movies)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;             EnterMovies();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;             did_enter_movies = 1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;       </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     <a class="code" href="struct_cv_capture___q_t___movie.html" title="Movie state structure for QuickTime movies.">CvCapture_QT_Movie</a> * capture = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     <span class="keywordflow">if</span> (filename)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;         capture = (<a class="code" href="struct_cv_capture___q_t___movie.html" title="Movie state structure for QuickTime movies.">CvCapture_QT_Movie</a> *) cvAlloc (<span class="keyword">sizeof</span> (*capture));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;         memset (capture, 0, <span class="keyword">sizeof</span>(*capture));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;             </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;         capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a33077781a714f3b33c17f8ec030fd026">vtable</a> = &amp;<a class="code" href="model_8cpp.html#a10ad9f314e0fc25afc7b31b390af4cd9">capture_QT_Movie_vtable</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="model_8cpp.html#a50bd7fb72964a02cb976ff34d75ce1cd">icvOpenFile_QT_Movie</a> (capture, filename))</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;             cvReleaseCapture ((CvCapture**) &amp; capture);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     <span class="keywordflow">return</span> (CvCapture*)capture;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_a86b0bd3f8986c2bfc219ef6e8a11d6ac_cgraph.svg" width="379" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6b8728b32f8cf36ebc87e18841c4814"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CV_IMPL CvVideoWriter* cvCreateVideoWriter </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fourcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CvSize&#160;</td>
          <td class="paramname"><em>frame_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_color</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01138">1138</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l01116">CvVideoWriter_QT::compression_session_ref</a>, <a class="el" href="model_8cpp_source.html#l01111">CvVideoWriter_QT::data_handler</a>, <a class="el" href="model_8cpp_source.html#l00068">did_enter_movies</a>, <a class="el" href="model_8cpp_source.html#l01118">CvVideoWriter_QT::duration_per_sample</a>, <a class="el" href="model_8cpp_source.html#l01412">icvEncodedFrameOutputCallback()</a>, <a class="el" href="model_8cpp_source.html#l01112">CvVideoWriter_QT::movie</a>, <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>, <a class="el" href="model_8cpp_source.html#l01121">TIME_SCALE</a>, <a class="el" href="model_8cpp_source.html#l01113">CvVideoWriter_QT::track</a>, and <a class="el" href="model_8cpp_source.html#l01114">CvVideoWriter_QT::video</a>.</p>
<div class="fragment"><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;     CV_FUNCNAME( <span class="stringliteral">&quot;cvCreateVideoWriter&quot;</span> );</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;     <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>* video_writer =</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         <span class="keyword">static_cast&lt;</span><a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>*<span class="keyword">&gt;</span>( cvAlloc( <span class="keyword">sizeof</span>( <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a> ) ) );</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;     memset( video_writer, 0, <span class="keyword">sizeof</span>( <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a> ) );</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;     Handle data_ref = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;     OSType data_ref_type;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;     DataHandler data_handler = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;     Movie movie = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;     ICMCompressionSessionOptionsRef options_ref = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;     ICMCompressionSessionRef compression_session_ref = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;     OSErr err = noErr;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;     __BEGIN__</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;     <span class="comment">// validate input arguments</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;     <span class="keywordflow">if</span> ( filename == <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;         CV_ERROR( CV_StsBadArg, <span class="stringliteral">&quot;Video file name must not be NULL&quot;</span> );</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;     }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;     <span class="keywordflow">if</span> ( fps &lt;= 0.0 ) {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;         CV_ERROR( CV_StsBadArg, <span class="stringliteral">&quot;FPS must be larger than 0.0&quot;</span> );</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;     }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;     <span class="keywordflow">if</span> ( ( frame_size.width &lt;= 0 ) || ( frame_size.height &lt;= 0 ) ) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;         CV_ERROR( CV_StsBadArg,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;             <span class="stringliteral">&quot;Frame width and height must be larger than 0&quot;</span> );</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;     }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;     <span class="comment">// initialize QuickTime</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;     <span class="keywordflow">if</span> ( !<a class="code" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a> ) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         err = EnterMovies();</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;         <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;             CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Unable to initialize QuickTime&quot;</span> );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <a class="code" href="model_8cpp.html#a0189ed6361bd1be03be79c2be6c3ad11">did_enter_movies</a> = 1;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;     }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;     <span class="comment">// convert the file name into a data reference</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;     CFStringRef out_path = CFStringCreateWithCString( kCFAllocatorDefault,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;         filename, kCFStringEncodingISOLatin1 );</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;     CV_ASSERT( out_path != nil );</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;     err = QTNewDataReferenceFromFullPathCFString( out_path, kQTPOSIXPathStyle,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         0, &amp;data_ref, &amp;data_ref_type );</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;     CFRelease( out_path );</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         CV_ERROR( CV_StsInternal,</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;             <span class="stringliteral">&quot;Cannot create data reference from file name&quot;</span> );</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;     }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;     <span class="comment">// create a new movie on disk</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;     err = CreateMovieStorage( data_ref, data_ref_type, <span class="stringliteral">&#39;TVOD&#39;</span>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         smCurrentScript, newMovieActive, &amp;data_handler, &amp;movie );</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot create movie storage&quot;</span> );</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;     }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;     <span class="comment">// create a track with video</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;     Track video_track =</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;         NewMovieTrack(</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;             movie,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;             FixRatio( frame_size.width, 1 ),</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;             FixRatio( frame_size.height, 1 ),</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;             kNoVolume</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;         );</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;     err = GetMoviesError();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot create video track&quot;</span> );</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;     }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;     Media video =</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         NewTrackMedia( video_track, VideoMediaType, <a class="code" href="model_8cpp.html#a2a6c76d3725e7fab57e3371d4e8ec368">TIME_SCALE</a>, nil, 0 );</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;     err = GetMoviesError();</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot create video media&quot;</span> );</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;     }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;     CodecType codecType;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;     <span class="keywordflow">switch</span> ( fourcc ) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;         <span class="keywordflow">case</span> CV_FOURCC( <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39; &#39;</span> ):</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;             codecType = kRawCodecType;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;             <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;         <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;             codecType = kRawCodecType;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;             <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;     }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;     <span class="comment">// start a compression session</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;     err = ICMCompressionSessionOptionsCreate( kCFAllocatorDefault,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         &amp;options_ref );</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot create compression session options&quot;</span> );</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;     }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;     err = ICMCompressionSessionOptionsSetAllowTemporalCompression( options_ref,</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;         <span class="keyword">true</span> );</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;     <span class="keywordflow">if</span> ( err != noErr) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot enable temporal compression&quot;</span> );</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;     }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;     err = ICMCompressionSessionOptionsSetAllowFrameReordering( options_ref,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         <span class="keyword">true</span> );</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;     <span class="keywordflow">if</span> ( err != noErr) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot enable frame reordering&quot;</span> );</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;     }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;     ICMEncodedFrameOutputRecord encoded_frame_output_record;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;     encoded_frame_output_record.encodedFrameOutputCallback =</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;         <a class="code" href="model_8cpp.html#a0d6a9e8427c3f98bd96e095acece3019">icvEncodedFrameOutputCallback</a>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;     encoded_frame_output_record.encodedFrameOutputRefCon =</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;         <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>( video_writer );</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;     encoded_frame_output_record.frameDataAllocator = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;     </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;     err = ICMCompressionSessionCreate( kCFAllocatorDefault, frame_size.width,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         frame_size.height, codecType, <a class="code" href="model_8cpp.html#a2a6c76d3725e7fab57e3371d4e8ec368">TIME_SCALE</a>, options_ref,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/*source_pixel_buffer_attributes*/</span>, &amp;encoded_frame_output_record,</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         &amp;compression_session_ref );</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;     ICMCompressionSessionOptionsRelease( options_ref );</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot create compression session&quot;</span> );</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;     }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;     err = BeginMediaEdits( video );</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;         CV_ERROR( CV_StsInternal, <span class="stringliteral">&quot;Cannot begin media edits&quot;</span> );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;     }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;     <span class="comment">// fill in the video writer structure</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adc875b7cbd0c8450a727ba5534f83a64">data_handler</a> = data_handler;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adf4b91735fd759a319d99599be9c3932">movie</a> = movie;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a6f6f1f870cd56f2a8223f9c97fdefd4b">track</a> = video_track;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#aad48d40b7753f9c5d7f69e61bab652e0">video</a> = video;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a92ce8519c307ece4558cb65cfe6c3e57">compression_session_ref</a> = compression_session_ref;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;     video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a6ef07479017175401a03e3865efd23ac">duration_per_sample</a> =</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;         <span class="keyword">static_cast&lt;</span>TimeValue<span class="keyword">&gt;</span>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( <a class="code" href="model_8cpp.html#a2a6c76d3725e7fab57e3371d4e8ec368">TIME_SCALE</a> ) / fps );</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;     __END__</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;     <span class="comment">// clean up in case of error (unless error processing mode is</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;     <span class="comment">// CV_ErrModeLeaf)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;     <span class="keywordflow">if</span> ( err != noErr ) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         <span class="keywordflow">if</span> ( options_ref != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;             ICMCompressionSessionOptionsRelease( options_ref );</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;         }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;         <span class="keywordflow">if</span> ( compression_session_ref != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;             ICMCompressionSessionRelease( compression_session_ref );</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;         }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;         <span class="keywordflow">if</span> ( data_handler != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;             CloseMovieStorage( data_handler );</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;         }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;         <span class="keywordflow">if</span> ( movie != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;             DisposeMovie( movie );</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;         }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;         <span class="keywordflow">if</span> ( data_ref != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;             DeleteMovieStorage( data_ref, data_ref_type );</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;             DisposeHandle( data_ref );</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;         }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;         cvFree( reinterpret_cast&lt;void**&gt;( &amp;video_writer ) );</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;         video_writer = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;     }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>CvVideoWriter*<span class="keyword">&gt;</span>( video_writer );</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_ac6b8728b32f8cf36ebc87e18841c4814_cgraph.svg" width="424" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae9c69d6abc1de26affe5f05c80556544"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CV_IMPL void cvReleaseVideoWriter </td>
          <td>(</td>
          <td class="paramtype">CvVideoWriter **&#160;</td>
          <td class="paramname"><em>writer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01363">1363</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l01116">CvVideoWriter_QT::compression_session_ref</a>, <a class="el" href="model_8cpp_source.html#l01111">CvVideoWriter_QT::data_handler</a>, <a class="el" href="model_8cpp_source.html#l01112">CvVideoWriter_QT::movie</a>, <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>, <a class="el" href="model_8cpp_source.html#l01113">CvVideoWriter_QT::track</a>, <a class="el" href="rc__fill_8cpp_source.html#l00023">TRUE</a>, and <a class="el" href="model_8cpp_source.html#l01114">CvVideoWriter_QT::video</a>.</p>
<div class="fragment"><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                                              {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;     <span class="keywordflow">if</span> ( ( writer != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) &amp;&amp; ( *writer != <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) ) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;         <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>* video_writer =</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;             <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>*<span class="keyword">&gt;</span>( *writer );</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;         <span class="comment">// force compression session to complete encoding of outstanding source</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;         <span class="comment">// frames</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;         ICMCompressionSessionCompleteFrames(</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;             video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a92ce8519c307ece4558cb65cfe6c3e57">compression_session_ref</a>, <a class="code" href="rc__fill_8cpp.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, 0, 0</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;         );</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;         EndMediaEdits( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#aad48d40b7753f9c5d7f69e61bab652e0">video</a> );</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         ICMCompressionSessionRelease( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a92ce8519c307ece4558cb65cfe6c3e57">compression_session_ref</a> );</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;         InsertMediaIntoTrack(</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;             video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a6f6f1f870cd56f2a8223f9c97fdefd4b">track</a>,</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;             0,</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;             0,</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;             GetMediaDuration( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#aad48d40b7753f9c5d7f69e61bab652e0">video</a> ),</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;             FixRatio( 1, 1 )</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;         );</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;         UpdateMovieInStorage( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adf4b91735fd759a319d99599be9c3932">movie</a>, video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adc875b7cbd0c8450a727ba5534f83a64">data_handler</a> );</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;         CloseMovieStorage( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adc875b7cbd0c8450a727ba5534f83a64">data_handler</a> );</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; <span class="comment">/*</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">         // export to AVI</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">         Handle data_ref;</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">         OSType data_ref_type;</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">         QTNewDataReferenceFromFullPathCFString(</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">             CFSTR( &quot;/Users/seibert/Desktop/test.avi&quot; ), kQTPOSIXPathStyle, 0,</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">             &amp;data_ref, &amp;data_ref_type</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">         );</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">         ConvertMovieToDataRef( video_writer-&gt;movie, NULL, data_ref,</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">             data_ref_type, kQTFileTypeAVI, &#39;TVOD&#39;, 0, NULL );</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">         DisposeHandle( data_ref );</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         DisposeMovie( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#adf4b91735fd759a319d99599be9c3932">movie</a> );</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;         cvFree( reinterpret_cast&lt;void**&gt;( &amp;video_writer ) );</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;         *writer = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;     }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0a117104b1ecf7a5e7cb747db9a68ad3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CV_IMPL int cvWriteFrame </td>
          <td>(</td>
          <td class="paramtype">CvVideoWriter *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IplImage *&#160;</td>
          <td class="paramname"><em>image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01307">1307</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l01116">CvVideoWriter_QT::compression_session_ref</a>, <a class="el" href="model_8cpp_source.html#l01118">CvVideoWriter_QT::duration_per_sample</a>, <a class="el" href="model_8cpp_source.html#l01427">icvSourceTrackingCallback()</a>, and <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;     <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>* video_writer =</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>*<span class="keyword">&gt;</span>( writer );</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;     CVPixelBufferRef pixel_buffer_ref = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;     CVReturn retval =</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         CVPixelBufferCreate(</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;             kCFAllocatorDefault,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;             image-&gt;width, image-&gt;height, k24RGBPixelFormat,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;             <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* pixel_buffer_attributes */</span>,</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;             &amp;pixel_buffer_ref</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;         );</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;     <span class="comment">// convert BGR IPL image to RGB pixel buffer</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;     IplImage* image_rgb =</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;         cvCreateImageHeader(</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;             cvSize( image-&gt;width, image-&gt;height ),</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;             IPL_DEPTH_8U,</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;             3</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;         );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;     retval = CVPixelBufferLockBaseAddress( pixel_buffer_ref, 0 );</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;     <span class="keywordtype">void</span>* base_address = CVPixelBufferGetBaseAddress( pixel_buffer_ref );</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;     <span class="keywordtype">size_t</span> bytes_per_row = CVPixelBufferGetBytesPerRow( pixel_buffer_ref );</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;     cvSetData( image_rgb, base_address, bytes_per_row );</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;     cvConvertImage( image, image_rgb, CV_CVTIMG_SWAP_RB );</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;     retval = CVPixelBufferUnlockBaseAddress( pixel_buffer_ref, 0 );</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;     cvReleaseImageHeader( &amp;image_rgb );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;     ICMSourceTrackingCallbackRecord source_tracking_callback_record;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;     source_tracking_callback_record.sourceTrackingCallback =</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;         <a class="code" href="model_8cpp.html#ad7d5370476eb03932f2aced2b7e577bd">icvSourceTrackingCallback</a>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;     source_tracking_callback_record.sourceTrackingRefCon = <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;     OSStatus status =</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;         ICMCompressionSessionEncodeFrame(</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;             video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a92ce8519c307ece4558cb65cfe6c3e57">compression_session_ref</a>,</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;             pixel_buffer_ref,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;             0,</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;             video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#a6ef07479017175401a03e3865efd23ac">duration_per_sample</a>,</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;             kICMValidTime_DisplayDurationIsValid,</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;             <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;             &amp;source_tracking_callback_record,</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;             static_cast&lt;void*&gt;( &amp;pixel_buffer_ref )</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;         );</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;     <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_a0a117104b1ecf7a5e7cb747db9a68ad3_cgraph.svg" width="344" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a572ed4a04e0129bd44db7839d3616949"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvClose_QT_Cam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01030">1030</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00576">CvCapture_QT_Cam_barg::grabber</a>, <a class="el" href="model_8cpp_source.html#l00578">CvCapture_QT_Cam_barg::gworld</a>, <a class="el" href="model_8cpp_source.html#l00586">CvCapture_QT_Cam_barg::image_bgr</a>, <a class="el" href="model_8cpp_source.html#l00585">CvCapture_QT_Cam_barg::image_rgb</a>, and <a class="el" href="model_8cpp_source.html#l00580">CvCapture_QT_Cam_barg::sequence</a>.</p>
<div class="fragment"><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;       OPENCV_ASSERT (capture, <span class="stringliteral">&quot;icvClose_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;       </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;       OSErr  result = noErr;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;       </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;       </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;       <span class="comment">// stop recording</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;       result = SGStop (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icveClose_QT_Cam&quot;</span>, <span class="stringliteral">&quot;couldnt stop recording&quot;</span>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;       <span class="comment">// close sequence grabber component</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;       result = CloseComponent (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icveClose_QT_Cam&quot;</span>, <span class="stringliteral">&quot;couldnt close sequence grabber component&quot;</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;       </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;       <span class="comment">// end decompression sequence</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;       CDSequenceEnd (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a58ab85d2aba380d023310ba0d8c964ad">sequence</a>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;       </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;       <span class="comment">// free memory</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;       cvReleaseImage (&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;       cvReleaseImageHeader (&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a>);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;       DisposeGWorld (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>); </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;       </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;       <span class="comment">// sucessful</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a94371ac572b7b5bcdfc3bd26b5f53911"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvClose_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>dispose of QuickTime Movie and free memory buffers</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-04 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00256">256</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00088">CvCapture_QT_Movie::image_bgr</a>, <a class="el" href="model_8cpp_source.html#l00087">CvCapture_QT_Movie::image_rgb</a>, <a class="el" href="model_8cpp_source.html#l00079">CvCapture_QT_Movie::myGWorld</a>, and <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       OPENCV_ASSERT (capture,          <span class="stringliteral">&quot;icvClose_QT_Movie&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, <span class="stringliteral">&quot;icvClose_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid Movie handle&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;       </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       <span class="comment">// deallocate and free resources</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;       cvReleaseImage       (&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aba5ca179fe74ac913a3d0c1a3eb762a0">image_bgr</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;       cvReleaseImageHeader (&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a7b362c70481a479d83eb5f336c83a9df">image_rgb</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       DisposeGWorld        (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a0e94183b3ae3010a814ae7bc6b321869">myGWorld</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       DisposeMovie         (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;       <span class="comment">// okay, that&#39;s it</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac61083c7a86014e3c5b70cb1bce82024"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static OSErr icvDataProc_QT_Cam </td>
          <td>(</td>
          <td class="paramtype">SGChannel&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Ptr&#160;</td>
          <td class="paramname"><em>raw_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TimeValue&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>refCon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00887">887</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00579">CvCapture_QT_Cam_barg::bounds</a>, <a class="el" href="model_8cpp_source.html#l00582">CvCapture_QT_Cam_barg::got_frame</a>, <a class="el" href="model_8cpp_source.html#l00578">CvCapture_QT_Cam_barg::gworld</a>, and <a class="el" href="model_8cpp_source.html#l00580">CvCapture_QT_Cam_barg::sequence</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00934">icvOpenCamera_QT()</a>.</p>
<div class="fragment"><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;       <a class="code" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam</a>  * capture = (<a class="code" href="struct_cv_capture___q_t___cam__barg.html">CvCapture_QT_Cam</a> *) refCon;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;       CodecFlags          ignore;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;       ComponentResult     err     = noErr;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;       </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;       </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;       <span class="comment">// we need valid pointers</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;       OPENCV_ASSERT (capture,          <span class="stringliteral">&quot;icvDataProc_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>,  <span class="stringliteral">&quot;icvDataProc_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;gworld&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;       OPENCV_ASSERT (raw_data,         <span class="stringliteral">&quot;icvDataProc_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;raw_data&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;       </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;       <span class="comment">// create a decompression sequence the first time</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;       <span class="keywordflow">if</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a58ab85d2aba380d023310ba0d8c964ad">sequence</a> == 0)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;       {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;             ImageDescriptionHandle   description = (ImageDescriptionHandle) NewHandle(0);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;             </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;             <span class="comment">// we need a decompression sequence that fits the raw data coming from the camera</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;             err = SGGetChannelSampleDescription (channel, (Handle) description);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;             OPENCV_ASSERT (err == noErr, <span class="stringliteral">&quot;icvDataProc_QT_Cam&quot;</span>, <span class="stringliteral">&quot;couldnt get channel sample description&quot;</span>);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             err = DecompressSequenceBegin (&amp;capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a58ab85d2aba380d023310ba0d8c964ad">sequence</a>, description, capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>, 0, &amp;capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>, </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                              nil, srcCopy, nil, 0, codecNormalQuality, bestSpeedCodec);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;             OPENCV_ASSERT (err == noErr, <span class="stringliteral">&quot;icvDataProc_QT_Cam&quot;</span>, <span class="stringliteral">&quot;couldnt begin decompression sequence&quot;</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;             DisposeHandle ((Handle) description);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;       }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;       </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;       <span class="comment">// okay, we have a decompression sequence -&gt; decompress!</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;       err = DecompressSequenceFrameS (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a58ab85d2aba380d023310ba0d8c964ad">sequence</a>, raw_data, len, 0, &amp;ignore, nil);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;       <span class="keywordflow">if</span> (err != noErr)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;       {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;icvDataProc_QT_Cam: couldn&#39;t decompress frame - %d\n&quot;</span>, (<span class="keywordtype">int</span>) err);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;             <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;       }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;       </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;       <span class="comment">// check if we dropped a frame</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">       #ifndef NDEBUG</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor"></span>             <span class="keywordflow">if</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a8d6a6b846b55bf93e9a62cd61d9d24a7">got_frame</a>)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                   fprintf (stderr, <span class="stringliteral">&quot;icvDataProc_QT_Cam: frame was dropped\n&quot;</span>);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">       #endif</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor"></span>       </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;       <span class="comment">// everything worked as expected</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a8d6a6b846b55bf93e9a62cd61d9d24a7">got_frame</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;       <span class="keywordflow">return</span> noErr;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_ac61083c7a86014e3c5b70cb1bce82024_icgraph.svg" width="576" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0d6a9e8427c3f98bd96e095acece3019"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OSStatus icvEncodedFrameOutputCallback </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ICMCompressionSessionRef&#160;</td>
          <td class="paramname"><em>compression_session_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OSStatus&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ICMEncodedFrameRef&#160;</td>
          <td class="paramname"><em>encoded_frame_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>reserved</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01412">1412</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>, and <a class="el" href="model_8cpp_source.html#l01114">CvVideoWriter_QT::video</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l01138">cvCreateVideoWriter()</a>.</p>
<div class="fragment"><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;   {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;     <a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>* video_writer = <span class="keyword">static_cast&lt;</span><a class="code" href="struct_cv_video_writer___q_t.html">CvVideoWriter_QT</a>*<span class="keyword">&gt;</span>( writer );</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;     OSStatus err = AddMediaSampleFromEncodedFrame( video_writer-&gt;<a class="code" href="struct_cv_video_writer___q_t.html#aad48d40b7753f9c5d7f69e61bab652e0">video</a>,</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;         encoded_frame_ref, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> );</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;     <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_a0d6a9e8427c3f98bd96e095acece3019_icgraph.svg" width="424" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41db6456f1485b1d5e81c90c00cceb8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double icvGetProperty_QT_Cam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>property_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>capture properties currently unimplemented for QuickTime camera interface </p>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00643">643</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;       assert (0);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;       <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85020f6603a6547001bf8721656ad706"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double icvGetProperty_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>property_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>get a capture property</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-05 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00277">277</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00082">CvCapture_QT_Movie::movie_start_time</a>, <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>, <a class="el" href="model_8cpp_source.html#l00085">CvCapture_QT_Movie::next_frame_number</a>, <a class="el" href="model_8cpp_source.html#l00084">CvCapture_QT_Movie::next_frame_time</a>, <a class="el" href="model_8cpp_source.html#l00083">CvCapture_QT_Movie::number_of_frames</a>, and <a class="el" href="model_8cpp_source.html#l00081">CvCapture_QT_Movie::size</a>.</p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;       OPENCV_ASSERT (capture,                        <span class="stringliteral">&quot;icvGetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>,               <span class="stringliteral">&quot;icvGetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid Movie handle&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a> &gt;  0, <span class="stringliteral">&quot;icvGetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;movie has invalid number of frames&quot;</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a> &gt;= 0, <span class="stringliteral">&quot;icvGetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;movie has invalid start time&quot;</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;       </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <span class="comment">// inquire desired property</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     <span class="keywordflow">switch</span> (property_id)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_FRAMES:</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                   <span class="keywordflow">return</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;             </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_MSEC:</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_AVI_RATIO:</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                   {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                         TimeValue   position  = capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a> - capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                         </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                         <span class="keywordflow">if</span> (property_id == CV_CAP_PROP_POS_MSEC)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                         {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                               TimeScale   timescale = GetMovieTimeScale (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                               <span class="keywordflow">return</span> (static_cast&lt;double&gt; (position) * 1000.0 / timescale);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                         }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                         {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                               TimeValue   duration  = GetMovieDuration  (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                               <span class="keywordflow">return</span> (static_cast&lt;double&gt; (position) / duration);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                         }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                   }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                   <span class="keywordflow">break</span>; <span class="comment">// never reached</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;             </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FRAME_WIDTH:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a>.width);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;             </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FRAME_HEIGHT:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a>.height);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;             </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FPS:</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                   {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                         TimeValue   duration  = GetMovieDuration  (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                         TimeScale   timescale = GetMovieTimeScale (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                         </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                         <span class="keywordflow">return</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a> / (static_cast&lt;double&gt; (duration) / timescale));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                   }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;             </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FRAME_COUNT:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;             </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FOURCC:  <span class="comment">// not implemented</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_FORMAT:  <span class="comment">// not implemented</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_MODE:    <span class="comment">// not implemented</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;             <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                   <span class="comment">// unhandled or unknown capture property</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                   OPENCV_ERROR (CV_StsBadArg, <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;unknown or unhandled property_id&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                   <span class="keywordflow">return</span> CV_StsBadArg;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7895bf39c5efdaba93e7a4c50f8858b7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvGrabFrame_QT_Cam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01057">1057</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00576">CvCapture_QT_Cam_barg::grabber</a>.</p>
<div class="fragment"><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;       OPENCV_ASSERT (capture,          <span class="stringliteral">&quot;icvGrabFrame_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, <span class="stringliteral">&quot;icvGrabFrame_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;grabber&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;       ComponentResult   result = noErr;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;       <span class="comment">// grab one frame</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;       result = SGIdle (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;       <span class="keywordflow">if</span> (result != noErr)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;       {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;SGIdle failed in icvGrabFrame_QT_Cam with error %d\n&quot;</span>, (<span class="keywordtype">int</span>) result);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;       }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;       </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;       <span class="comment">// successful</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0d146e4c912ae502f9a33a4773d4661"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvGrabFrame_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the original meaning of this method is to acquire raw frame data for the next video frame but not decompress it. With the QuickTime video reader, this is reduced to advance to the current frame time.</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-06 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00454">454</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>, <a class="el" href="model_8cpp_source.html#l00085">CvCapture_QT_Movie::next_frame_number</a>, <a class="el" href="model_8cpp_source.html#l00084">CvCapture_QT_Movie::next_frame_time</a>, and <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;       OPENCV_ASSERT (capture,          <span class="stringliteral">&quot;icvGrabFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, <span class="stringliteral">&quot;icvGrabFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid Movie handle&quot;</span>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;       </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;       TimeValue    myCurrTime;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;       OSType       myType     = VisualMediaCharacteristic;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;       OSErr        myErr      = noErr;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;       </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       <span class="comment">// jump to current video sample</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;       SetMovieTimeValue (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;       myErr = GetMoviesError();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;       {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t SetMovieTimeValue() in icvGrabFrame_QT_Movie.\n&quot;</span>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;             <span class="keywordflow">return</span>  0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;       }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;       </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;       <span class="comment">// where are we now?</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;       myCurrTime = GetMovieTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;       </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;       <span class="comment">// increment counters</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>++;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;       GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, nextTimeStep, 1, &amp; myType, myCurrTime, 1, &amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;       myErr = GetMoviesError();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;       {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t GetMovieNextInterestingTime() in icvGrabFrame_QT_Movie.\n&quot;</span>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;       }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;       </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;       <span class="comment">// that&#39;s it</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;     <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa9e2854609da08709c8cfe52a33ac543"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvOpenCamera_QT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00934">934</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00579">CvCapture_QT_Cam_barg::bounds</a>, <a class="el" href="model_8cpp_source.html#l00577">CvCapture_QT_Cam_barg::channel</a>, <a class="el" href="model_8cpp_source.html#l00576">CvCapture_QT_Cam_barg::grabber</a>, <a class="el" href="model_8cpp_source.html#l00578">CvCapture_QT_Cam_barg::gworld</a>, <a class="el" href="model_8cpp_source.html#l00887">icvDataProc_QT_Cam()</a>, <a class="el" href="model_8cpp_source.html#l00586">CvCapture_QT_Cam_barg::image_bgr</a>, <a class="el" href="model_8cpp_source.html#l00585">CvCapture_QT_Cam_barg::image_rgb</a>, and <a class="el" href="model_8cpp_source.html#l00584">CvCapture_QT_Cam_barg::size</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00618">cvCaptureFromCAM_QT()</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;       OPENCV_ASSERT (capture,    <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;       OPENCV_ASSERT (index &gt;= 0, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;camera index is negative&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;       </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;       PixMapHandle  pixmap       = nil;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;       OSErr         result       = noErr;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;       </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;       <span class="comment">// open sequence grabber component</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a> = OpenDefaultComponent (SeqGrabComponentType, 0);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt create image&quot;</span>);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;       </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;       <span class="comment">// initialize sequence grabber component</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;       result = SGInitialize (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt initialize sequence grabber&quot;</span>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;       result = SGSetDataRef (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, 0, 0, seqGrabDontMakeMovie);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set data reference of sequence grabber&quot;</span>);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;       </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;       <span class="comment">// set up video channel</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;       result = SGNewChannel (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, VideoMediaType, &amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>));</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt create new video channel&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;       </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;       <span class="comment">// query natural camera resolution -- this will be wrong, but will be an upper</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;       <span class="comment">// bound on the actual resolution -- the actual resolution is set below</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;       <span class="comment">// after starting the frame grabber</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;       result = SGGetSrcVideoBounds (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>, &amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>));</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set video channel bounds&quot;</span>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;       <span class="comment">// create offscreen GWorld</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;       result = QTNewGWorld (&amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>), k32ARGBPixelFormat, &amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>), 0, 0, 0);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;       result = SGSetGWorld (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>, 0);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set GWorld for sequence grabber&quot;</span>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;       result = SGSetChannelBounds (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>, &amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>));</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set video channel bounds&quot;</span>);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;       result = SGSetChannelUsage (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>, seqGrabRecord);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set channel usage&quot;</span>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;     <span class="comment">// start recording so we can size</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;       result = SGStartRecord (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt start recording&quot;</span>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;       <span class="comment">// don&#39;t know *actual* resolution until now</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;       ImageDescriptionHandle imageDesc = (ImageDescriptionHandle)NewHandle(0);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;       result = SGGetChannelSampleDescription(capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>, (Handle)imageDesc);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;       OPENCV_ASSERT( result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldn&#39;t get image size&quot;</span>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.right = (**imageDesc).width;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.bottom = (**imageDesc).height;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;       DisposeHandle ((Handle) imageDesc);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;       <span class="comment">// stop grabber so that we can reset the parameters to the right size</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;       result = SGStop (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icveClose_QT_Cam&quot;</span>, <span class="stringliteral">&quot;couldnt stop recording&quot;</span>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;       <span class="comment">// reset GWorld to correct image size</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;       GWorldPtr tmpgworld;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;       result = QTNewGWorld( &amp;tmpgworld, k32ARGBPixelFormat, &amp;(capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>), 0, 0, 0);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt create offscreen GWorld&quot;</span>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;       result = SGSetGWorld( capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, tmpgworld, 0);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set GWorld for sequence grabber&quot;</span>);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;       DisposeGWorld( capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a> );</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a> = tmpgworld;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;       result = SGSetChannelBounds (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#ac88a080abadc2a43eef9ae1753996207">channel</a>, &amp; (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>));</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set video channel bounds&quot;</span>);  </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;       <span class="comment">// allocate images</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a35aa003c8c05eea2a20dff99b19b07bd">size</a> = cvSize (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.right - capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.left, capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.bottom - capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a510cef383f428fb615018940e1cf3143">bounds</a>.top);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;       </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;       <span class="comment">// build IplImage header that points to the PixMap of the Movie&#39;s GWorld.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;       <span class="comment">// unfortunately, cvCvtColor doesn&#39;t know ARGB, the QuickTime pixel format,</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;       <span class="comment">// so we shift the base address by one byte.</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;       <span class="comment">// ATTENTION: don&#39;t access the last pixel&#39;s alpha entry, it&#39;s inexistant</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a> = cvCreateImageHeader (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a35aa003c8c05eea2a20dff99b19b07bd">size</a>, IPL_DEPTH_8U, 4);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a>, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt create image header&quot;</span>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;       pixmap = GetGWorldPixMap (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#af018f0d70e2983c2618291ac7efa6ae3">gworld</a>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;       OPENCV_ASSERT (pixmap, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;didn&#39;t get GWorld PixMap handle&quot;</span>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;       LockPixels (pixmap);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;       cvSetData (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a>, GetPixBaseAddr (pixmap) + 1, GetPixRowBytes (pixmap));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;       </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;       <span class="comment">// create IplImage that hold correctly formatted result</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a> = cvCreateImage (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a35aa003c8c05eea2a20dff99b19b07bd">size</a>, IPL_DEPTH_8U, 3);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a>, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt create image&quot;</span>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;       </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;       <span class="comment">// tell the sequence grabber to invoke our data proc</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;       result = SGSetDataProc (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>, NewSGDataUPP (<a class="code" href="model_8cpp.html#ac61083c7a86014e3c5b70cb1bce82024">icvDataProc_QT_Cam</a>), (<span class="keywordtype">long</span>) capture);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt set data proc&quot;</span>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;       </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;       <span class="comment">// start recording</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;       result = SGStartRecord (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;       OPENCV_ASSERT (result == noErr, <span class="stringliteral">&quot;icvOpenCamera_QT&quot;</span>, <span class="stringliteral">&quot;couldnt start recording&quot;</span>);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_aa9e2854609da08709c8cfe52a33ac543_cgraph.svg" width="358" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_aa9e2854609da08709c8cfe52a33ac543_icgraph.svg" width="374" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a50bd7fb72964a02cb976ff34d75ce1cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvOpenFile_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>convert full path to CFStringRef and open corresponding Movie. Then step over 'interesting frame times' to count total number of frames for video material with varying frame durations and create offscreen GWorld for rendering the movie frames.</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-04 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00150">150</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00088">CvCapture_QT_Movie::image_bgr</a>, <a class="el" href="model_8cpp_source.html#l00087">CvCapture_QT_Movie::image_rgb</a>, <a class="el" href="model_8cpp_source.html#l00082">CvCapture_QT_Movie::movie_start_time</a>, <a class="el" href="model_8cpp_source.html#l00079">CvCapture_QT_Movie::myGWorld</a>, <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>, <a class="el" href="model_8cpp_source.html#l00085">CvCapture_QT_Movie::next_frame_number</a>, <a class="el" href="model_8cpp_source.html#l00084">CvCapture_QT_Movie::next_frame_time</a>, <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>, <a class="el" href="model_8cpp_source.html#l00083">CvCapture_QT_Movie::number_of_frames</a>, and <a class="el" href="model_8cpp_source.html#l00081">CvCapture_QT_Movie::size</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00114">cvCaptureFromFile_QT()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       Rect          myRect;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;       <span class="keywordtype">short</span>         myResID        = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       Handle        myDataRef      = nil;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       OSType        myDataRefType  = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;       OSErr         myErr          = noErr;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       <span class="comment">// no old errors please</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       ClearMoviesStickyError ();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       <span class="comment">// initialize pointers to zero</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>  = 0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a0e94183b3ae3010a814ae7bc6b321869">myGWorld</a> = nil;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;       <span class="comment">// initialize numbers with invalid values</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>   = -1;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a> = -1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a>  = -1;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a>  = -1;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a>              = cvSize (-1,-1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;       </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;       </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;       <span class="comment">// we would use CFStringCreateWithFileSystemRepresentation (kCFAllocatorDefault, filename) on Mac OS X 10.4</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       CFStringRef   inPath = CFStringCreateWithCString (kCFAllocatorDefault, filename, kCFStringEncodingISOLatin1);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;       OPENCV_ASSERT ((inPath != nil), <span class="stringliteral">&quot;icvOpenFile_QT_Movie&quot;</span>, <span class="stringliteral">&quot;couldnt create CFString from a string&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;       </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;       <span class="comment">// create the data reference</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;       myErr = QTNewDataReferenceFromFullPathCFString (inPath, kQTPOSIXPathStyle, 0, &amp; myDataRef, &amp; myDataRefType);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;       {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t create QTNewDataReferenceFromFullPathCFString().\n&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;       </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;       <span class="comment">// get the Movie</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;       myErr = NewMovieFromDataRef(&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, newMovieActive | newMovieAsyncOK <span class="comment">/* | newMovieIdleImportOK */</span>,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                 &amp; myResID, myDataRef, myDataRefType);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       <span class="comment">// dispose of the data reference handle - we no longer need it</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       DisposeHandle (myDataRef);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       <span class="comment">// if NewMovieFromDataRef failed, we already disposed the DataRef, so just return with an error</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t create a NewMovieFromDataRef() - error is %d.\n&quot;</span>,  myErr);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;       }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       <span class="comment">// count the number of video &#39;frames&#39; in the movie by stepping through all of the</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       <span class="comment">// video &#39;interesting times&#39;, or in other words, the places where the movie displays</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       <span class="comment">// a new video sample. The time between these interesting times is not necessarily constant.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;       {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;             OSType      whichMediaType = VisualMediaCharacteristic;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;             TimeValue   theTime        = -1;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;             </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;             <span class="comment">// find out movie start time</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;             GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, short (nextTimeMediaSample + nextTimeEdgeOK), </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                          1, &amp; whichMediaType, TimeValue (0), 0, &amp; theTime, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;             <span class="keywordflow">if</span> (theTime == -1)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;             {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                   fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t inquire first frame time\n&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;             }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;             capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a>  = theTime;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;             capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>   = theTime;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;             capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a> = 0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;             </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;             <span class="comment">// count all &#39;interesting times&#39; of the movie</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;             capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a>  = 0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;             <span class="keywordflow">while</span> (theTime &gt;= 0) </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;             {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                   GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, short (nextTimeMediaSample), </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                                1, &amp; whichMediaType, theTime, 0, &amp; theTime, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                   capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a>++;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;             }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;       <span class="comment">// get the bounding rectangle of the movie</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;       GetMoviesError ();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       GetMovieBox (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, &amp; myRect);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a> = cvSize (myRect.right - myRect.left, myRect.bottom - myRect.top);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;       </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;       <span class="comment">// create gworld for decompressed image</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;       myErr = QTNewGWorld (&amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a0e94183b3ae3010a814ae7bc6b321869">myGWorld</a>, k32ARGBPixelFormat <span class="comment">/* k24BGRPixelFormat geht leider nicht */</span>, </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                            &amp; myRect, nil, nil, 0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;       OPENCV_ASSERT (myErr == noErr, <span class="stringliteral">&quot;icvOpenFile_QT_Movie&quot;</span>, <span class="stringliteral">&quot;couldnt create QTNewGWorld() for output image&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;       SetMovieGWorld (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a0e94183b3ae3010a814ae7bc6b321869">myGWorld</a>, nil);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;       </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;       <span class="comment">// build IplImage header that will point to the PixMap of the Movie&#39;s GWorld later on</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a7b362c70481a479d83eb5f336c83a9df">image_rgb</a> = cvCreateImageHeader (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a>, IPL_DEPTH_8U, 4);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       <span class="comment">// create IplImage that hold correctly formatted result</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aba5ca179fe74ac913a3d0c1a3eb762a0">image_bgr</a> = cvCreateImage (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aec8a219b5ade4c43b76c08a82fb05a6b">size</a>, IPL_DEPTH_8U, 3);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;       <span class="comment">// okay, that&#39;s it - should we wait until the Movie is playable?</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_a50bd7fb72964a02cb976ff34d75ce1cd_icgraph.svg" width="379" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acecd5e598aed1d847417d4f9ccb56343"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const void * icvRetrieveFrame_QT_Cam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01077">1077</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00582">CvCapture_QT_Cam_barg::got_frame</a>, <a class="el" href="model_8cpp_source.html#l00576">CvCapture_QT_Cam_barg::grabber</a>, <a class="el" href="model_8cpp_source.html#l00586">CvCapture_QT_Cam_barg::image_bgr</a>, and <a class="el" href="model_8cpp_source.html#l00585">CvCapture_QT_Cam_barg::image_rgb</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;       OPENCV_ASSERT (capture,            <span class="stringliteral">&quot;icvRetrieveFrame_QT_Cam&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a>, <span class="stringliteral">&quot;icvRetrieveFrame_QT_Cam&quot;</span>, <span class="stringliteral">&quot;invalid source image&quot;</span>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a>, <span class="stringliteral">&quot;icvRetrieveFrame_QT_Cam&quot;</span>, <span class="stringliteral">&quot;invalid destination image&quot;</span>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;       </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;       OSErr         myErr          = noErr;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;       </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;       <span class="comment">// service active sequence grabbers (= redraw immediately)</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;       <span class="keywordflow">while</span> (! capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a8d6a6b846b55bf93e9a62cd61d9d24a7">got_frame</a>)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;       {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;             myErr = SGIdle (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a381e01aaedaaa8e61263e695e0bc862c">grabber</a>);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;             <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;             {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                   fprintf (stderr, <span class="stringliteral">&quot;SGIdle() didn&#39;t succeed in icvRetrieveFrame_QT_Cam().\n&quot;</span>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;             }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;       }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;       </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;       <span class="comment">// covert RGB of GWorld to BGR</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;       cvCvtColor (capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a6b279f306b387cf254d6f49bd4e9bfa8">image_rgb</a>, capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a>, CV_RGBA2BGR);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;       </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;       <span class="comment">// reset grabbing status</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;       capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a8d6a6b846b55bf93e9a62cd61d9d24a7">got_frame</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;       </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;     <span class="comment">// always return the same image pointer</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;       <span class="keywordflow">return</span> capture-&gt;<a class="code" href="struct_cv_capture___q_t___cam__barg.html#a928e4d96bbc5ca80da9a11918ddef403">image_bgr</a>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec296cc7fb38a048d40a8ffeded6955a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const void * icvRetrieveFrame_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>render the current frame into an image buffer and convert to OpenCV IplImage buffer layout (BGR sampling)</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-06 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00497">497</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00088">CvCapture_QT_Movie::image_bgr</a>, <a class="el" href="model_8cpp_source.html#l00087">CvCapture_QT_Movie::image_rgb</a>, <a class="el" href="model_8cpp_source.html#l00079">CvCapture_QT_Movie::myGWorld</a>, and <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       OPENCV_ASSERT (capture,            <span class="stringliteral">&quot;icvRetrieveFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>,   <span class="stringliteral">&quot;icvRetrieveFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid Movie handle&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a7b362c70481a479d83eb5f336c83a9df">image_rgb</a>, <span class="stringliteral">&quot;icvRetrieveFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid source image&quot;</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aba5ca179fe74ac913a3d0c1a3eb762a0">image_bgr</a>, <span class="stringliteral">&quot;icvRetrieveFrame_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid destination image&quot;</span>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       PixMapHandle  myPixMapHandle = nil;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;       OSErr         myErr          = noErr;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;       </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;       <span class="comment">// invalidates the movie&#39;s display state so that the Movie Toolbox </span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;       <span class="comment">// redraws the movie the next time we call MoviesTask</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;       UpdateMovie (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;       myErr = GetMoviesError ();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;       {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t UpdateMovie() in icvRetrieveFrame_QT_Movie().\n&quot;</span>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;       }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       <span class="comment">// service active movie (= redraw immediately)</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       MoviesTask (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, 0L);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       myErr = GetMoviesError ();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;       <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;             fprintf (stderr, <span class="stringliteral">&quot;MoviesTask() didn&#39;t succeed in icvRetrieveFrame_QT_Movie().\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;             <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;       }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;       <span class="comment">// update IplImage header that points to PixMap of the Movie&#39;s GWorld.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;       <span class="comment">// unfortunately, cvCvtColor doesn&#39;t know ARGB, the QuickTime pixel format,</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;       <span class="comment">// so we pass a modfied address.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;       <span class="comment">// ATTENTION: don&#39;t access the last pixel&#39;s alpha entry, it&#39;s inexistant</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;       myPixMapHandle = GetGWorldPixMap (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a0e94183b3ae3010a814ae7bc6b321869">myGWorld</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;       LockPixels (myPixMapHandle);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;       cvSetData (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a7b362c70481a479d83eb5f336c83a9df">image_rgb</a>, GetPixBaseAddr (myPixMapHandle) + 1, GetPixRowBytes (myPixMapHandle));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;       </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;       <span class="comment">// covert RGB of GWorld to BGR</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;       cvCvtColor (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a7b362c70481a479d83eb5f336c83a9df">image_rgb</a>, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aba5ca179fe74ac913a3d0c1a3eb762a0">image_bgr</a>, CV_RGBA2BGR);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;       </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;       <span class="comment">// allow QuickTime to access the buffer again</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;       UnlockPixels (myPixMapHandle);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;       </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     <span class="comment">// always return the same image pointer</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;       <span class="keywordflow">return</span> capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#aba5ca179fe74ac913a3d0c1a3eb762a0">image_bgr</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33e22d6a68e54e7592b7b195323d0e8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvSetProperty_QT_Cam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="model_8cpp.html#acd38e6e426619bef990fd9f1c6c94657">CvCapture_QT_Cam</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>property_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>capture properties currently unimplemented for QuickTime camera interface </p>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00650">650</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;       assert (0);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;       <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c67e69138599d1acab7910e30278d33"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int icvSetProperty_QT_Movie </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_cv_capture___q_t___movie.html">CvCapture_QT_Movie</a> *&#160;</td>
          <td class="paramname"><em>capture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>property_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>set a capture property. With movie files, it is only possible to set the position (i.e. jump to a given time or frame number)</p>
<dl class="section author"><dt>Author</dt><dd>Mark Asbach <a href="#" onclick="location.href='mai'+'lto:'+'asb'+'ac'+'h@i'+'en'+'t.r'+'wt'+'h-a'+'ac'+'hen'+'.d'+'e'; return false;">asbac<span style="display: none;">.nosp@m.</span>h@ie<span style="display: none;">.nosp@m.</span>nt.rw<span style="display: none;">.nosp@m.</span>th-a<span style="display: none;">.nosp@m.</span>achen<span style="display: none;">.nosp@m.</span>.de</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-11-05 </dd></dl>

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00344">344</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>References <a class="el" href="model_8cpp_source.html#l00082">CvCapture_QT_Movie::movie_start_time</a>, <a class="el" href="model_8cpp_source.html#l00078">CvCapture_QT_Movie::myMovie</a>, <a class="el" href="model_8cpp_source.html#l00085">CvCapture_QT_Movie::next_frame_number</a>, <a class="el" href="model_8cpp_source.html#l00084">CvCapture_QT_Movie::next_frame_time</a>, <a class="el" href="tiffio_8h_source.html#l00101">NULL</a>, and <a class="el" href="model_8cpp_source.html#l00083">CvCapture_QT_Movie::number_of_frames</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;       OPENCV_ASSERT (capture,                        <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;&#39;capture&#39; is a NULL-pointer&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>,               <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;invalid Movie handle&quot;</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a9b73d90eae9321c25dfdad5bee2f7265">number_of_frames</a> &gt;  0, <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;movie has invalid number of frames&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;       OPENCV_ASSERT (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a> &gt;= 0, <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;movie has invalid start time&quot;</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     <span class="comment">// inquire desired property</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       <span class="comment">// </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;       <span class="comment">// rework these three points to really work through &#39;interesting times&#39;.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;       <span class="comment">// with the current implementation, they result in wrong times or wrong frame numbers with content that </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;       <span class="comment">// features varying frame durations</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     <span class="keywordflow">switch</span> (property_id)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;     {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_MSEC:</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_AVI_RATIO:</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                   {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                         TimeValue    destination;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                         OSType       myType     = VisualMediaCharacteristic;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                         OSErr        myErr      = noErr;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                         <span class="keywordflow">if</span> (property_id == CV_CAP_PROP_POS_MSEC)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                         {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                               TimeScale  timescale   = GetMovieTimeScale      (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                          destination = <span class="keyword">static_cast&lt;</span>TimeValue<span class="keyword">&gt;</span> (value / 1000.0 * timescale + capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                         }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                         {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                               TimeValue  duration    = GetMovieDuration       (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                          destination = <span class="keyword">static_cast&lt;</span>TimeValue<span class="keyword">&gt;</span> (value * duration + capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a6eb609d56bcae949fbce8f507e0f12a0">movie_start_time</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                         }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                         </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                         <span class="comment">// really seek?</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                         <span class="keywordflow">if</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a> == destination)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                         </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                         <span class="comment">// seek into which direction?</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                         <span class="keywordflow">if</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a> &lt; destination)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                         {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                               <span class="keywordflow">while</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a> &lt; destination)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                               {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                     capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>++;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                     GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, nextTimeStep, 1, &amp; myType, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>,  </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                                  1, &amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                     myErr = GetMoviesError();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                     <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                     {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                           fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t go on to GetMovieNextInterestingTime() in icvGrabFrame_QT.\n&quot;</span>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                           <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                     }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                               }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                         }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                         {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                               <span class="keywordflow">while</span> (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a> &gt; destination)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                               {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                     capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>--;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                     GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, nextTimeStep, 1, &amp; myType, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                                  -1, &amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                     myErr = GetMoviesError();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                     <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                     {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                           fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t go back to GetMovieNextInterestingTime() in icvGrabFrame_QT.\n&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                           <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                     }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                               }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                         }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                   }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;             </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;             <span class="keywordflow">case</span> CV_CAP_PROP_POS_FRAMES:</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                   {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                         TimeValue    destination = <span class="keyword">static_cast&lt;</span>TimeValue<span class="keyword">&gt;</span> (value);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                         <span class="keywordtype">short</span>        direction   = (destination &gt; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>) ? 1 : -1;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                         OSType       myType      = VisualMediaCharacteristic;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                         OSErr        myErr       = noErr;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                         </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                         <span class="keywordflow">while</span> (destination != capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a>)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                         {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                               capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a5e933398b820eb5bdfffc62fdc203d07">next_frame_number</a> += direction;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                               GetMovieNextInterestingTime (capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#adb08f8a973f6919bc6fdabaad3f7799d">myMovie</a>, nextTimeStep, 1, &amp; myType, capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                                          direction, &amp; capture-&gt;<a class="code" href="struct_cv_capture___q_t___movie.html#a4a977ffcda08b94cdcbb3a247cc9af4a">next_frame_time</a>, <a class="code" href="tiffio_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                               myErr = GetMoviesError();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                               <span class="keywordflow">if</span> (myErr != noErr)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                               {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                     fprintf (stderr, <span class="stringliteral">&quot;Couldn&#39;t step to desired frame number in icvGrabFrame_QT.\n&quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                     <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                               }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                         }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                   }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;             </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;             <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                   <span class="comment">// unhandled or unknown capture property</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                   OPENCV_ERROR (CV_StsBadArg, <span class="stringliteral">&quot;icvSetProperty_QT_Movie&quot;</span>, <span class="stringliteral">&quot;unknown or unhandled property_id&quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;       }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;       </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;       <span class="comment">// positive result means success</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad7d5370476eb03932f2aced2b7e577bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icvSourceTrackingCallback </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>source_tracking_ref_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ICMSourceTrackingFlags&#160;</td>
          <td class="paramname"><em>source_tracking_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>source_frame_ref_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>reserved</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01427">1427</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l01307">cvWriteFrame()</a>.</p>
<div class="fragment"><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;     <span class="keywordflow">if</span> ( source_tracking_flags &amp; kICMSourceTracking_ReleasedPixelBuffer ) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;         CVPixelBufferRelease(</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;             *static_cast&lt;CVPixelBufferRef*&gt;( source_frame_ref_con )</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;         );</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;     }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="model_8cpp_ad7d5370476eb03932f2aced2b7e577bd_icgraph.svg" width="344" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a036076d0c44cb1eea47533204801b0e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CvCaptureVTable capture_QT_Cam_vtable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= </div>
<div class="line"> {</div>
<div class="line">     6,</div>
<div class="line">     (CvCaptureCloseFunc)           <a class="code" href="model_8cpp.html#a572ed4a04e0129bd44db7839d3616949">icvClose_QT_Cam</a>,</div>
<div class="line">     (CvCaptureGrabFrameFunc)       <a class="code" href="model_8cpp.html#a7895bf39c5efdaba93e7a4c50f8858b7">icvGrabFrame_QT_Cam</a>,</div>
<div class="line">     (CvCaptureRetrieveFrameFunc)   <a class="code" href="model_8cpp.html#acecd5e598aed1d847417d4f9ccb56343">icvRetrieveFrame_QT_Cam</a>,</div>
<div class="line">     (CvCaptureGetPropertyFunc)     <a class="code" href="model_8cpp.html#a41db6456f1485b1d5e81c90c00cceb8e" title="capture properties currently unimplemented for QuickTime camera interface">icvGetProperty_QT_Cam</a>,</div>
<div class="line">     (CvCaptureSetPropertyFunc)     <a class="code" href="model_8cpp.html#a33e22d6a68e54e7592b7b195323d0e8c" title="capture properties currently unimplemented for QuickTime camera interface">icvSetProperty_QT_Cam</a>,</div>
<div class="line">     (CvCaptureGetDescriptionFunc)  0</div>
<div class="line"> }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="model_8cpp_source.html#l00600">600</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00618">cvCaptureFromCAM_QT()</a>.</p>

</div>
</div>
<a class="anchor" id="a10ad9f314e0fc25afc7b31b390af4cd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CvCaptureVTable capture_QT_Movie_vtable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= </div>
<div class="line"> {</div>
<div class="line">     6,</div>
<div class="line">     (CvCaptureCloseFunc)           <a class="code" href="model_8cpp.html#a94371ac572b7b5bcdfc3bd26b5f53911">icvClose_QT_Movie</a>,</div>
<div class="line">     (CvCaptureGrabFrameFunc)       <a class="code" href="model_8cpp.html#af0d146e4c912ae502f9a33a4773d4661">icvGrabFrame_QT_Movie</a>,</div>
<div class="line">     (CvCaptureRetrieveFrameFunc)   <a class="code" href="model_8cpp.html#aec296cc7fb38a048d40a8ffeded6955a">icvRetrieveFrame_QT_Movie</a>,</div>
<div class="line">     (CvCaptureGetPropertyFunc)     <a class="code" href="model_8cpp.html#a85020f6603a6547001bf8721656ad706">icvGetProperty_QT_Movie</a>,</div>
<div class="line">     (CvCaptureSetPropertyFunc)     <a class="code" href="model_8cpp.html#a2c67e69138599d1acab7910e30278d33">icvSetProperty_QT_Movie</a>,</div>
<div class="line">     (CvCaptureGetDescriptionFunc)  0</div>
<div class="line"> }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="model_8cpp_source.html#l00102">102</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00114">cvCaptureFromFile_QT()</a>.</p>

</div>
</div>
<a class="anchor" id="a0189ed6361bd1be03be79c2be6c3ad11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int did_enter_movies = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l00068">68</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l00618">cvCaptureFromCAM_QT()</a>, <a class="el" href="model_8cpp_source.html#l00114">cvCaptureFromFile_QT()</a>, and <a class="el" href="model_8cpp_source.html#l01138">cvCreateVideoWriter()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a6c76d3725e7fab57e3371d4e8ec368"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TimeScale const TIME_SCALE = 600</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="model_8cpp_source.html#l01121">1121</a> of file <a class="el" href="model_8cpp_source.html">model.cpp</a>.</p>

<p>Referenced by <a class="el" href="model_8cpp_source.html#l01138">cvCreateVideoWriter()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5594f77850edb42952de1f5e8c94226d.html">visual</a></li><li class="navelem"><a class="el" href="dir_9971d4040db76cab1e0b580d86bb5f6f.html">code</a></li><li class="navelem"><a class="el" href="model_8cpp.html">model.cpp</a></li>
    <li class="footer">Generated on Fri Jan 10 2014 20:59:34 for Visible by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
